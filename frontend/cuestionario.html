<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Formulario por secciones</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.13.1/font/bootstrap-icons.css">
    <link rel="stylesheet" href="Styles/form.css">
</head>

<body>

<div class="container">

    <!-- SECCIÓN 1 -->
    <div id="section1" class="section active">
        <h2>Estado emocional general</h2>

        <div class="question">
            <label>¿Cuál es tu estado de ánimo actual?</label>
            <select id="mood">
                <option>Feliz</option>
                <option>triste</option>
                <option>estresado</option>
                <option>ansioso</option>
                <option>relajado</option>
                <option>sin energía</option>
                <option>motivado</option>
                <option>neutral</option>
            </select>
        </div>

        <div class="question">
            <label>¿Cómo describirías tu nivel de ansiedad hoy? (1–10)</label>
            <input id="anxiety" type="number" min="1" max="10">
        </div>

        <div class="question">
            <label>¿Qué tan estresado te sientes actualmente? (1–10)</label>
            <input id="stress" type="number" min="1" max="10">
        </div>

        <div class="question">
            <label>Describe tu preocupación principal del día:</label>
            <textarea id="mainConcern" rows="3"></textarea>
        </div>

        <button onclick="nextSection(1)">Siguiente</button>
    </div>

    <!-- SECCIÓN 2 -->
    <div id="section2" class="section">
        <button class="back-btn" onclick="previousSection(2)"><i class="bi bi-arrow-left"></i></button>
        <h2>Salud emocional específica</h2>

        <div class="question">
            <label>¿Has tenido problemas para dormir?</label>
            <select id="sleepProblem" onchange="toggleSleepSeverity()">
                <option value="Sí">Sí</option>
                <option value="No">No</option>
            </select>
        </div>

        <div id="sleepSeverityBox" class="question" style="display:none;">
            <label>¿Qué tan grave ha sido? (1–10)</label>
            <input id="sleepSeverity" type="number" min="1" max="10">
        </div>

        <div class="question">
            <label>¿Pensamientos repetitivos o dificultad para desconectarte? (1–10)</label>
            <input id="rumination" type="number" min="1" max="10">
        </div>

        <div class="question">
            <label>¿Te has sentido triste o con baja autoestima? (1–10)</label>
            <input id="lowMood" type="number" min="1" max="10">
        </div>

        <button onclick="nextSection(2)">Siguiente</button>
    </div>

    <!-- SECCIÓN 3 -->
    <div id="section3" class="section">
        <button class="back-btn" onclick="previousSection(3)"><i class="bi bi-arrow-left"></i></button>
        <h2>Preferencias musicales</h2>

        <div class="question">
            <label>¿Cuáles son tus géneros musicales favoritos?</label>
            <div class="checkbox-group">
                <label><input type="checkbox" class="genreCheck" value="lofi"> lofi</label>
                <label><input type="checkbox" class="genreCheck" value="pop"> pop</label>
                <label><input type="checkbox" class="genreCheck" value="rock"> rock</label>
                <label><input type="checkbox" class="genreCheck" value="reggaetón"> reggaetón</label>
                <label><input type="checkbox" class="genreCheck" value="electrónica"> electrónica</label>
                <label><input type="checkbox" class="genreCheck" value="clásica"> clásica</label>
            </div>
        </div>

        <div class="question">
            <label>Artistas que escuchas con más frecuencia:</label>
            <input id="artists" type="text">
        </div>

        <button onclick="submitForm()">Finalizar</button>
    </div>

</div>

<script>
function nextSection(current) {
    document.getElementById("section" + current).classList.remove("active");
    document.getElementById("section" + (current + 1)).classList.add("active");
}

function previousSection(current) {
    document.getElementById("section" + current).classList.remove("active");
    document.getElementById("section" + (current - 1)).classList.add("active");
}

function toggleSleepSeverity() {
    const box = document.getElementById("sleepSeverityBox");
    const val = document.getElementById("sleepProblem").value;
    box.style.display = val === "Sí" ? "block" : "none";
}

function submitForm() {
    const selectedGenres = [...document.querySelectorAll('.genreCheck:checked')].map(g => g.value);

    const data = {
        mood: document.getElementById("mood").value,
        anxiety: Number(document.getElementById("anxiety").value),
        stress: Number(document.getElementById("stress").value),
        mainConcern: document.getElementById("mainConcern").value,
        sleepIssues: {
            hasProblem: document.getElementById("sleepProblem").value === "Sí",
            severity: document.getElementById("sleepProblem").value === "Sí" 
                ? Number(document.getElementById("sleepSeverity").value) 
                : 0
        },
        rumination: Number(document.getElementById("rumination").value),
        lowMood: Number(document.getElementById("lowMood").value),
        genres: selectedGenres,
        artists: document.getElementById("artists").value
    };

    console.log("JSON enviado al backend:", data);
    alert("Datos listos para enviar al backend. Revisa la consola.");
}
</script>

</body>
</html>